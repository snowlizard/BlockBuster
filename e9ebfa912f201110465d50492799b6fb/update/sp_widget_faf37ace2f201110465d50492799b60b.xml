<?xml version="1.0" encoding="UTF-8"?><record_update table="sp_widget">
    <sp_widget action="INSERT_OR_UPDATE">
        <category>custom</category>
        <client_script><![CDATA[api.controller=function($rootScope, $scope, spUtil, $uibModal, spModal) {
  /* widget controller */
  var c = this;
	
	c.movies = c.data.movies;
	
	//-- listen for
	$rootScope.$on('filterGenre', function(e, arg){
		if(arg){
			c.movies = c.data.movies.filter(function(item){
				if(item.genre.includes(arg))
					return item;
			})
		}
		else c.movies = c.data.movies;
	});
	
	c.openModal = function(movie) {
		c.modalInstance = $uibModal.open({
			templateUrl: 'movieModal',
			scope: $scope,
			size: 'md',
			controllerAs: 'modalC',
			controller: function() {
				var modalC = this;
				modalC.movie = movie;
				modalC.modalInstance = c.modalInstance;
			}
		});
	}
	
	c.closeModal = function(){
		c.modalInstance.close();
	}
	
	c.addToCart = function(movie){
		// add to cart
		
		c.modalInstance.close();
	}
};]]></client_script>
        <controller_as>c</controller_as>
        <css>.movie-list-container{
	width:100%;
  height:100%;
  display: flex;
  flex-flow: column wrap;
  align-items: center;
}

.movies-container{
	width: 100%;
  height: 90%;
  display: flex;
  flex-wrap: wrap;
  justify-content: center;
  align-items: center;
}

.movie-container{
  width: 150px;
  height: 250px;
  margin: 10px;
}

.movie-container:hover{
  box-shadow: 1px 1px 10px rgba(204, 201, 184, 0.8);
}

.movie-poster{
  width: 100%;
  height:100%;
}</css>
        <data_table>sp_instance</data_table>
        <demo_data/>
        <description/>
        <docs/>
        <field_list/>
        <has_preview>true</has_preview>
        <id>movie_list</id>
        <internal>false</internal>
        <link><![CDATA[function link(scope, element, attrs, controller) {  }]]></link>
        <name>Movie list</name>
        <option_schema/>
        <public>false</public>
        <roles/>
        <script><![CDATA[(function() {
	// -- Get movies from server
	var movies = [];
	
	var gr = new GlideRecord('x_809069_bbuster_u_cmdb_ci_movie');
	gr.query();
	
	while(gr.next()){
		var object = {};
		object.poster = gr.getValue('u_poster');
		object.genre  = gr.getValue('u_genre');
		object.title  = gr.getValue('u_title');
		object.rating = gr.getValue('u_rating');
		object.plot   = gr.getValue('u_plot');
		object.actors = gr.getValue('u_actors');
		object.year   = gr.getValue('year');
		object.directors    = gr.getValue('u_directors');
		object.metascore    = gr.getValue('u_metascore');
		object.release_date = gr.getValue('u_release_date');
		movies.push(object);
	}
	data.movies = movies;
	// -----------
	
})();]]></script>
        <servicenow>false</servicenow>
        <sys_class_name>sp_widget</sys_class_name>
        <sys_created_by>jgonzalez</sys_created_by>
        <sys_created_on>2022-07-09 06:39:49</sys_created_on>
        <sys_id>faf37ace2f201110465d50492799b60b</sys_id>
        <sys_mod_count>151</sys_mod_count>
        <sys_name>Movie list</sys_name>
        <sys_package display_value="BlockBuster" source="x_809069_bbuster">e9ebfa912f201110465d50492799b6fb</sys_package>
        <sys_policy/>
        <sys_scope display_value="BlockBuster">e9ebfa912f201110465d50492799b6fb</sys_scope>
        <sys_update_name>sp_widget_faf37ace2f201110465d50492799b60b</sys_update_name>
        <sys_updated_by>jgonzalez</sys_updated_by>
        <sys_updated_on>2022-07-20 03:43:28</sys_updated_on>
        <template><![CDATA[<div class="movie-list-container">
  
  <div class="movies-container">
    <div class="movie-container" ng-repeat="movie in c.movies"
         ng-click="c.openModal(movie)">
      <img class="movie-poster" src="{{movie.poster}}" />
    </div>
  </div>
  
  <uib-pagination total-items="50" ng-model="currentPage" ng-change="pageChanged()"></uib-pagination>
</div>]]></template>
    </sp_widget>
</record_update>
