<?xml version="1.0" encoding="UTF-8"?><record_update table="sp_widget">
    <sp_widget action="INSERT_OR_UPDATE">
        <category>custom</category>
        <client_script><![CDATA[api.controller=function(spUtil, spModal) {
  /* widget controller */
  var c = this;
	
	c.requests = c.data.table;
	
	c.requestForm = function(request){
		spModal.open({
			widget: 'widget-form',
			size: 'lg',
			widgetInput: {
				table: 'sc_request',
				sys_id: request.sys_id
			},
			buttons: []
		})
	}
	
};]]></client_script>
        <controller_as>c</controller_as>
        <css>.panel-heading{
	background: #ffa903;
}

.panel-main{
	border-color: #36454F;
}

.item{
  display:flex;
  justify-content: space-between;
}</css>
        <data_table>sp_instance</data_table>
        <demo_data/>
        <description/>
        <docs/>
        <field_list/>
        <has_preview>true</has_preview>
        <id>user_requests</id>
        <internal>false</internal>
        <link><![CDATA[function link(scope, element, attrs, controller) {  }]]></link>
        <name>User Requests</name>
        <option_schema/>
        <public>false</public>
        <roles/>
        <script><![CDATA[(function() {
	
	// array of requests requested by the current user
	data.table = [];
	
	var gr = new GlideRecord('sc_request');
	gr.addQuery('requested_for', gs.getUserID());
	gr.query();
	
	while(gr.next()){
		var obj = {};
		obj.number = gr.getValue('number');
		obj.sys_id = gr.getValue('sys_id');
		obj.price  = gr.getValue('price');
		obj.opened_at = gr.getValue('opened_at');
		data.table.push(obj);
	}

})();]]></script>
        <servicenow>false</servicenow>
        <sys_class_name>sp_widget</sys_class_name>
        <sys_created_by>jgonzalez</sys_created_by>
        <sys_created_on>2022-07-30 02:33:36</sys_created_on>
        <sys_id>09054ebc2fc51110465d50492799b600</sys_id>
        <sys_mod_count>39</sys_mod_count>
        <sys_name>User Requests</sys_name>
        <sys_package display_value="BlockBuster" source="x_809069_bbuster">e9ebfa912f201110465d50492799b6fb</sys_package>
        <sys_policy/>
        <sys_scope display_value="BlockBuster">e9ebfa912f201110465d50492799b6fb</sys_scope>
        <sys_update_name>sp_widget_09054ebc2fc51110465d50492799b600</sys_update_name>
        <sys_updated_by>jgonzalez</sys_updated_by>
        <sys_updated_on>2022-07-30 03:52:21</sys_updated_on>
        <template><![CDATA[<div class="panel panel-default panel-main">
  <div class="panel-heading">
    My Requests
  </div>
  
	<ul class="list-group">
    <li class="list-group-item item"
        ng-repeat="request in c.requests"
        ng-click="c.requestForm(request)">
      <span>{{request.number}}</span>
      <span>{{request.opened_at}}</span>
    </li>
  </ul>
</div>]]></template>
    </sp_widget>
</record_update>
